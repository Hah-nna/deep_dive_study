# 브라우저 동작원리

<im src="https://poiemaweb.com/img/client-server.png>

사용자가 선택한 자원을 서버에 요청하고 브라우저에 표시하는 것이다
여기서 말하는 자원에는 html, css, javascript, image 등이 속한다(보통은 html문서임)

브라우저는 사용자가 요구한 웹페이지를 서버에 request하고 서버로부터 response를 받아 브라우저에 표시함
브라우저는 서버로부터 자원을 응답으로 받음.
HTML, CSS파일은 렌더링 엔진에 의해 파싱되어 DOM, CSSOM 트리로 변환 -> 렌더 트리로 결합됨
이렇게 생성된 렌더 트리를 기반으로 브라우저는 웹 페이지를 표시함

이 때 자바크스립트는 렌더링 엔진이 아닌 자바스크립트 엔진이 처리함
HTML 파일을 파싱하는 HTML 파서는 script 태그를 만나면 자바스크립트 코드를 실행하기 위해 DOM 생성 프로세스를 중지하고 자바스크립트 엔진으로 제어권한을 넘김
자바스크립트의 실행이 완료되면 다시 HTML 파서로 권한을 넘겨 브라우저가 중지했던 곳 부터 다시 DOM 생성을 시작함

앞에서 보다시피 브라우저는 동기적으로 파일들을 처리함
즉 script 태그 위치에 따라서 DOM 생성이 지연될 수 있다는 것을 말한다
따라서 body 가장 아래 script 태그를 위치시키면 다음과 같은 면에서 좋음

- HTML 요소들이 스크립트 로딩 지연으로 인해 렌더링에 지장 받는 일이 발생하지 않아 페이지 로딩 시간이 단축됌
- DOM이 완성되지 않은 상태에서 js가 DOM을 조작하려고 하면 에러('Cannot read property ㅇㅇㅇ of null' 등의 타입에러)가 발생하는데 이러한 에러를 방지할 수 있음
  (저러한 에러가 나는 이유는 js가 DOM 요소가 아직 생성 되지 않았다는 걸 인식하지 못하고 null이나 undefined를 리턴하기 때문임)
